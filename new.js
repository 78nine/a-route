var ARoute=function(e){"use strict";var t=g,n=c,r=function(e,t){return l(c(e,t),t)},a=l,o=h,i="/",s=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function c(e,t){for(var n,r=[],a=0,o=0,c="",l=t&&t.delimiter||i,u=t&&t.whitelist||void 0,h=!1;null!==(n=s.exec(e));){var g=n[0],m=n[1],d=n.index;if(c+=e.slice(o,d),o=d+g.length,m)c+=m[1],h=!0;else{var v="",x=n[2],y=n[3],E=n[4],b=n[5];if(!h&&c.length){var w=c.length-1,R=c[w];(!u||u.indexOf(R)>-1)&&(v=R,c=c.slice(0,w))}c&&(r.push(c),c="",h=!1);var A="+"===b||"*"===b,k="?"===b||"*"===b,T=y||E,$=v||l;r.push({name:x||a++,prefix:v,delimiter:$,optional:k,repeat:A,pattern:T?f(T):"[^"+p($===l?$:$+l)+"]+?"})}}return(c||o<e.length)&&r.push(c+e.substr(o)),r}function l(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",u(t)));return function(t,r){for(var a="",o=r&&r.encode||encodeURIComponent,i=!r||!1!==r.validate,s=0;s<e.length;s++){var c=e[s];if("string"!=typeof c){var l,p=t?t[c.name]:void 0;if(Array.isArray(p)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but got array');if(0===p.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var f=0;f<p.length;f++){if(l=o(p[f],c),i&&!n[s].test(l))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'"');a+=(0===f?c.prefix:c.delimiter)+l}}else if("string"!=typeof p&&"number"!=typeof p&&"boolean"!=typeof p){if(!c.optional)throw new TypeError('Expected "'+c.name+'" to be '+(c.repeat?"an array":"a string"))}else{if(l=o(String(p),c),i&&!n[s].test(l))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but got "'+l+'"');a+=c.prefix+l}}else a+=c}return a}}function p(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function f(e){return e.replace(/([=!:$/()])/g,"\\$1")}function u(e){return e&&e.sensitive?"":"i"}function h(e,t,n){for(var r=(n=n||{}).strict,a=!1!==n.start,o=!1!==n.end,s=n.delimiter||i,c=[].concat(n.endsWith||[]).map(p).concat("$").join("|"),l=a?"^":"",f=0;f<e.length;f++){var h=e[f];if("string"==typeof h)l+=p(h);else{var g=h.repeat?"(?:"+h.pattern+")(?:"+p(h.delimiter)+"(?:"+h.pattern+"))*":h.pattern;t&&t.push(h),h.optional?h.prefix?l+="(?:"+p(h.prefix)+"("+g+"))?":l+="("+g+")?":l+=p(h.prefix)+"("+g+")"}}if(o)r||(l+="(?:"+p(s)+")?"),l+="$"===c?"$":"(?="+c+")";else{var m=e[e.length-1],d="string"==typeof m?m[m.length-1]===s:void 0===m;r||(l+="(?:"+p(s)+"(?="+c+"))?"),d||(l+="(?="+p(s)+"|"+c+")")}return new RegExp(l,u(n))}function g(e,t,n){return e instanceof RegExp?function(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,n){for(var r=[],a=0;a<e.length;a++)r.push(g(e[a],t,n).source);return new RegExp("(?:"+r.join("|")+")",u(n))}(e,t,n):function(e,t,n){return h(c(e,n),t,n)}(e,t,n)}t.parse=n,t.compile=r,t.tokensToFunction=a,t.tokensToRegExp=o;const{create:m,freeze:d,keys:v}=Object,x=customElements.get("a-route"),y=x?x.app:d({_:d({params:m(null),paths:m(null)}),get(e){for(let{paths:t}=y._,n=[],r="*"===e?"*":b(e,n),a=t[r]||(t[r]={keys:n,re:r,cb:[]}),o=1,{length:i}=arguments;o<i;o++)a.cb.push(arguments[o]);return y},delete(e){for(let t="*"===e?"*":b(e,[]),n=y._.paths[t],r=1,{length:a}=arguments;r<a;r++){const e=arguments[r],t=n?n.cb.lastIndexOf(e):-1;-1<t&&n.cb.splice(t,1)}return y},navigate(e){const{params:t,paths:n}=y._;for(let r in n){if("*"===r)continue;const a=n[r],o=a.re.exec(e);if(o){const n={path:e,params:A(o,a.keys)},r=v(n.params).filter(w,t);return function e(){if(r.length){const a=r.shift();t[a](n,e,n.params[a])}else R(n,a.cb.slice(0))}()}}"*"in n&&R({path:e},n["*"].cb.slice(0))},param(e,t){for(let{params:n}=y._,r=[].concat(e),a=0,{length:o}=r;a<o;a++)n[r[a]]=t;return y},use(e,t){"function"==typeof e&&(t=e,e="(.*)");for(let n=[].concat(e),r=0,{length:a}=n;r<a;r++)y.get(n[r],t);return y}}),E=x||class extends HTMLAnchorElement{static get app(){return y}connectedCallback(){this.addEventListener("click",this)}disconnectedCallback(){this.removeEventListener("click",this)}handleEvent(e){e.preventDefault(),this.hasAttribute("no-propagation")&&e.stopPropagation();const{pathname:t,search:n,hash:r}=new URL(this.href),a=t+n+r;this.hasAttribute("replace")?history.replaceState(location.href,document.title,a):history.pushState(location.href,document.title,a),y.navigate(a)}};function b(e,n){return"string"!=typeof e&&(e=(e=e.toString()).slice(1,e.lastIndexOf("/"))),t(e,n)}function w(e){return e in this}function R(e,t){const n=[];!function r(){const a=t.shift();a&&(n.lastIndexOf(a)<0?(n.push(a),a(e,r)):r())}()}function A(e,t){const n=m(null);for(let r=1,{length:a}=e;r<a;r++)null!=e[r]&&(n[t[r-1].name]=e[r]);return n}return x||(customElements.define("a-route",E,{extends:"a"}),addEventListener("popstate",(function(){const{pathname:e,search:t,hash:n}=new URL(location.href);y.navigate(e+t+n)}))),e.ARoute=E,e.app=y,e}({});
